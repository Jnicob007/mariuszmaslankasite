<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <meta name="keywords" content="Mariusz, Maślanka, Artist, Art, Norway, Poland" />
  <meta name="description" content="Mariusz Maślanka (b. 1992, Poland) is an artist living and working in Oslo, Norway." />

  <title>Mariusz Maślanka</title>

  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="https://use.typekit.net/lri0fdy.css">

</head>

<body class="index">

  <!-- NAVIGATION -->
  <div id="buttons">
    <a href="cv.html">CV</a>
    <a href="contact.html">Contact</a>
  </div>

  <main>
    <div id="gallery">
      <div id="photo-wrapper">
        
        <!-- Placeholder rezerwuje miejsce przed załadowaniem zdjęcia -->
        <div id="photo-placeholder"></div>

        <!-- Zdjęcie -->
        <img id="photo" alt="" />

        <!-- Opis zdjęcia -->
        <div id="photo-info">
          <p id="photo-description"></p>
        </div>

      </div>
    </div>
  </main>


  <script>

    const properties = [
      { title: "Frozen Estate", description: "2020, Installation view, SIC! Gallery, BWA Wrocław, photo. Alicja Kielan" },
      { title: "Frozen Estate", description: "2020, Installation view, SIC! Gallery, BWA Wrocław, photo. Alicja Kielan" },
      { title: "Frozen Estate", description: "2020, Installation view, SIC! Gallery, BWA Wrocław, photo. Alicja Kielan" },
      { title: "Frozen Estate", description: "2020, Installation view, SIC! Gallery, BWA Wrocław, photo. Alicja Kielan" },
      { title: "Frozen Estate", description: "2022, Installation view, Kunstnernes Hus, photo. Vegard Kleven" },
      { title: "The night will drive a heart", description: "2021, Exhibition view, Wrocław Contemporary Museum (MWW), photo. Alicja Kielan" },
      { title: "It’s not too late to change your mind", description: "2023, Exhibition view, Kunstnernes Hus, photo. Kunstdok" },
      { title: "Balcony", description: "2023, Installation view, Kunstnernes Hus, photo. Kunstdok" },
      { title: "Sleepwalking I", description: "2023, Installation view, Kunstnernes Hus, photo. Kunstdok" },
      { title: "Sleepwalking", description: "2023, Installation view, Hulias, photo. Jørn Aagaard" },
      { title: "Sleepwalking", description: "2023, Installation view, Hulias, photo. Jørn Aagaard" },
      { title: "Sleepwalking VI", description: "2024, Installation view, Krupa Gallery, photo. Krupa Gallery" },
      { title: "Sleepwalking V", description: "2023, Installation view, Hulias, photo. Jørn Aagaard" },
      { title: "Sleepwalking IV", description: "2023, Installation view, Hulias, photo. Jørn Aagaard" },
      { title: "Shadows", description: "2025, Installation view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Shadows", description: "2025, Installation view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Shadows", description: "2025, Installation view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Shadows", description: "2025, Installation view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Shadows", description: "2025, Installation view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Shadows", description: "2025, Installation view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Days Wide Open", description: "2025, Exhibition view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Days Wide Open", description: "2025, Exhibition view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Days Wide Open", description: "2025, Exhibition view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Days Wide Open", description: "2025, Exhibition view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Days Wide Open", description: "2025, Exhibition view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Days Wide Open", description: "2025, Exhibition view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Days Wide Open", description: "2025, Exhibition view, Centralbanken, photo. Lea Stuedahl" },
      { title: "Angel", description: "2024, Installation view, Loftet, photo. Lea Stuedahl" },
      { title: "Angel", description: "2024, Installation view, Loftet, photo. Lea Stuedahl" },
      { title: "Sleepwalking", description: "2023, Installation view, Hulias, photo. Jørn Aagaard" },
      { title: "Escargatoire", description: "2025, Exhibition view, Snails, photo. Snails" },
      { title: "Spaces Between Us", description: "2025, Installation view, Snails, photo. Snails" },
      { title: "Spaces Between Us", description: "2025, Installation view, Snails, photo. Snails" },
      { title: "Escargatoire", description: "2025, Exhibition view, Snails, photo. Snails" }
    ];

    const photo = document.querySelector("#photo");
    const placeholder = document.querySelector("#photo-placeholder");
    const description = document.querySelector("#photo-description");
    const info = document.querySelector("#photo-info");
    const wrapper = document.querySelector("#photo-wrapper");
    const FADE_MS = 300;
    let currentPhotoNumber = -1;
    let isLoading = false;

    function pickRandomPhotoNumber() {
      if (properties.length <= 1) {
        return 0;
      }
      let next = Math.floor(Math.random() * properties.length);
      while (next === currentPhotoNumber) {
        next = Math.floor(Math.random() * properties.length);
      }
      return next;
    }

    function loadPhoto(photoNumber, options = {}) {
      if (isLoading) {
        return;
      }
      isLoading = true;
      const src = `${photoNumber}.jpg`;
      const usePlaceholder = options.usePlaceholder !== false;

      description.innerHTML =
        `<i>${properties[photoNumber].title}</i>, ${properties[photoNumber].description}`;
      photo.alt = description.innerText;

      if (usePlaceholder) {
        placeholder.style.display = "block";
      }

      const preImg = new Image();
      preImg.onload = () => {
        if (usePlaceholder) {
          const ratio = preImg.naturalWidth / preImg.naturalHeight;
          placeholder.style.aspectRatio = ratio;
        }

        photo.src = src;

        requestAnimationFrame(() => {
          if (usePlaceholder) {
            placeholder.style.display = "none";
          } else {
            photo.style.width = "";
            photo.style.height = "";
            wrapper.style.width = "";
            wrapper.style.height = "";
            info.style.width = "";
          }
          photo.classList.add("loaded");
          info.classList.add("loaded");
          updatePhotoInfoOnResize();
          isLoading = false;
        });
      };
      preImg.src = src;
    }

    function loadRandomPhoto() {
      const next = pickRandomPhotoNumber();
      currentPhotoNumber = next;
      loadPhoto(next);
    }

    loadRandomPhoto();



function updatePhotoInfoOnResize() {
  // przy resize ponownie ustaw szerokość wrappera na aktualny rozmiar zdjęcia
  // (usuń twarde width jeśli chcesz, żeby wrapper znowu był elastyczny — ale wtedy Safari może znowu mieć bug)
  wrapper.style.width = photo.offsetWidth + "px";
  info.style.width = photo.offsetWidth + "px";
}

photo.addEventListener("click", () => {
  if (isLoading) {
    return;
  }
  isLoading = true;
  const freezeWidth = photo.offsetWidth;
  const freezeHeight = photo.offsetHeight;
  if (freezeWidth && freezeHeight) {
    wrapper.style.width = freezeWidth + "px";
    wrapper.style.height = freezeHeight + "px";
    info.style.width = freezeWidth + "px";
    photo.style.width = freezeWidth + "px";
    photo.style.height = freezeHeight + "px";
  }
  let didHandle = false;

  const onFadeOut = (event) => {
    if (event.propertyName !== "opacity") {
      return;
    }
    photo.removeEventListener("transitionend", onFadeOut);
    didHandle = true;
    const next = pickRandomPhotoNumber();
    currentPhotoNumber = next;
    isLoading = false;
    loadPhoto(next, { usePlaceholder: false });
  };

  photo.addEventListener("transitionend", onFadeOut);
  photo.classList.remove("loaded");
  info.classList.remove("loaded");

  setTimeout(() => {
    photo.removeEventListener("transitionend", onFadeOut);
    if (didHandle) {
      return;
    }
    const next = pickRandomPhotoNumber();
    currentPhotoNumber = next;
    isLoading = false;
    loadPhoto(next, { usePlaceholder: false });
  }, FADE_MS);
});

  window.addEventListener('DOMContentLoaded', () => {
    requestAnimationFrame(() => {
      document.body.classList.add('page-loaded');
    });
  });

  window.addEventListener("resize", updatePhotoInfoOnResize);

  </script>

</body>
</html>
